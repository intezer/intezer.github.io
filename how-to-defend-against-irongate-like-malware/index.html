<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="description" content="Intezer Labs Cyber Security Blog" />
    <meta name="keywords" content="intezer, reverse engineering, reverse engineer, python, ida, ida pro, ollydbg, hex-rays, idapython, ida plugins, ida plugin, malware analysis, cyber security, malware, malware analyst" />
    <meta name="author" content="intezer"/>
    <!--[if lte IE 8]><script src="css/ie/html5shiv.js"></script><![endif]-->
    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery.dropotron.min.js"></script>
    <script src="/js/skel.min.js"></script>
    <script src="/js/skel-layers.min.js"></script>
    <script src="/js/init.js"></script>
    <link rel="stylesheet" href="/css/pygment.css" />
    <noscript>
        <link rel="stylesheet" href="/css/skel.css" />
        <link rel="stylesheet" href="/css/style.css" />
        <link rel="stylesheet" href="/css/style-noscript.css" />
    </noscript>
    <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
    <link  href="http://fonts.googleapis.com/css?family=Anonymous+Pro:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css" >
    <!--[if lte IE 8]><link rel="stylesheet" href="/css/ie/v8.css" /><![endif]-->
    <!--[if lte IE 9]><link rel="stylesheet" href="/css/ie/v9.css" /><![endif]-->

    <title>How to Defend Against IRONGATE-like malware? | Intezer </title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width">
</head>

<body class=" loading">



    <!-- Header -->
    <!--<header id="header" > -->
	<header id="header">
	<div class="logo">
		<a href=".."><img src="/images/logo.png" height="30" alt="Intezer Labs"/></a>
		<a href=".."><span class='title-text'>BLOG</span></a>
	</div>
        <nav id="nav">
            <ul>
                <!-- <li class="current"><a href="index.html">Welcome</a></li> -->
                <!--<li class="submenu">
                    <a href="../">Categories</a>
                    <ul>
                            <li class="active">
                                <a href="../category/reverse engineering tools/">Reverse Engineering Tools</a>
                            </li>
                    </ul>
                </li>-->
                <li><a href="http://www.intezer.com" class="button special">Learn More About Us</a></li>
            </ul>
        </nav>
    </header>

<!-- Main -->
<article id="main">

  <header class="special container" style='padding-top:0'>
    <p style='margin-bottom:0'><img src="/images/rsz_1pyinstaller.png" alt="How to Defend Against IRONGATE-like malware?"/></p>
    <!--<span class="icon fa-/images/rsz_1pyinstaller.png"></span>-->
    <h2>How to Defend Against IRONGATE-like malware?</h2>
    <!-- add page sub title here -->
    <p>Posted on Thu 16 June 2016 by Intezer Labs</p>
    <!--<p>/images/rsz_1pyinstaller.png</p>-->
  </header>

  <!-- One -->
    <section class="wrapper style4 container">

      <!-- Content -->
        <div class="content">
          <section>
            <!-- <a href="#" class="image feature"><img src="images/pic04.jpg" alt="" /></a> -->
            <!--<h3>Posted in <a href="../category/reverse-engineering-tools/">Reverse Engineering Tools</a></h3>-->
            <p class="tags">
</p>
            <p><p><head>
<meta charset="UTF-8">
<meta name="description" content="Python Malware">
<meta name="keywords" content="python, python malware, pyinstaller, yara signatures, malware analysis, malware, virustotal, fireeye, irongate, irongate malware">
<meta name="author" content="Intezer">
</head>
<strong>How to Defend Against IRONGATE-like malware?</strong></p>
<p>A lot of the recent buzz in the InfoSec community was about the <a href="https://www.fireeye.com/blog/threat-research/2016/06/irongate_ics_malware.html">IRONGATE malware</a>. IRONGATE was recently discovered by <a href="https://www.fireeye.com/">FireEye</a> while hunting for PyInstaller-crafted executables in <a href="https://www.virustotal.com/">VirusTotal</a>.</p>
<p><a href="http://www.pyinstaller.org/">PyInstaller</a> is a program that converts Python scripts into stand-alone executables under Windows, Linux, and more. Due to the simplicity of Python development and the easy deployment of Python programs enabled by PyInstaller, malware authors are able to write sophisticated malware in no time.</p>
<p>But how can we defend against these kind of threats?
We need to perform the following steps:</p>
<ol style="margin-left:20px;">
  <li>1. Identify PyInstaller executables</li>
  <li>2. Analyze the PyInstaller executable by reviewing its original Python script code</li>
  <li>3. Remediate according to the specific threat found</li>
</ol>

<p><strong>Identifying PyInstaller Executables</strong></p>
<p>There's a YARA signature created by <a href="https://blog.didierstevens.com/"> Didier Stevens</a> that can be used in either an automatic or a manual mode to detect PyInstaller files. This signature basically looks for a specific string which is unique to PyInstaller-crafted executables.</p>
<p><a href="https://github.com/Yara-Rules/rules/blob/master/malware/pyinstaller.yar">PyInstaller Yara Signature</a></p>
<p><strong>Analyzing The PyInstaller Executable</strong></p>
<p>To deal with PyInstaller files, we can extract the original Python source code from any PyInstaller file and then analyze the code to get an understanding about its purpose, maliciousness, and full threat potential.  </p>
<p>Unlike other executable binaries, for which we need to perform disassembly and review hard-to-read assembly code in order to fully analyze them, the process of analysis using PyInstaller is usually simple and fast. It fully exposes the entire Python code, making it easy to read.</p>
<p>Extracting the Python source code can be done by using the excellent <a href="http://sourceforge.net/projects/pyinstallerextractor">pyinstxtractor project</a></p>
<p>It is used by running the pyinstallerextractor script: <strong>python pyinstxtractor.py PYINSTALLER_TEST_FILE.exe</strong></p>
<p>Now, in the directory where you run pyinstxtractor, you should have the Python source code available to you. The only thing left is to rapidly read the code and analyze what it's doing in your system.</p>
<p><strong>Remediation</strong></p>
<p>Remediation for PyInstaller files is not especially different from any other cyber threats; it really depends on the security systems deployed in your organization, and the code of the threat itself.  </p>
<p>If you need any assistance regarding a specific case, we would be happy to help -- just visit our <a href="http://www.intezer.com">website</a> or contact us via email at <a href="contact@intezer.com">contact@intezer.com</a></p></p>
	    <p><b>About Intezer</b></p>
	    <p>
After years of experience and research, we are soon launching a game-changing cloud service for instant, deep analysis of unknown cyber threats. It will transform unknown files and memory dumps into an open book â€“ as if an experienced reverse engineer has analyzed the whole assembly code.</p> 
<p>Subscribe to our mailing list through our <a href=http://www.intezer.com>website</a> to get notified about our upcoming launch!</p>
          </section>
        </div>

    </section>

    <!-- Two -->
    <section class="wrapper style1 container special">
        <div class="row">
          <div class="4u">

            <section>
              <span class="icon feature fa-/images/rsz_1pyinstaller.png"></span>
              <header>
                <a href="../how-to-defend-against-irongate-like-malware" rel='bookmark'><h3>How to Defend Against IRONGATE-like malware?</h3></a>
<h4> Thu 16 June 2016 </h4>
              </header>
              <p><p>After a recent buzz in the Infosec community about IRONGATE malware, we would like to provide you insight into detecting and defeating these IRONGATE-like types of malware.</p></p>
              <footer>
                  <ul class="buttons">
                      <li><a href="../how-to-defend-against-irongate-like-malware" class="button small">Read More</a></li>
                  </ul>
              </footer>
            </section>

          </div>
          <div class="4u">

            <section>
              <span class="icon feature fa-/images/docker-ida-top-down-small.png"></span>
              <header>
                <a href="../docker-ida" rel='bookmark'><h3>Docker IDA</h3></a>
<h4> Thu 26 May 2016 </h4>
              </header>
              <p><p>Docker IDA is an open-source tool used to make reverse engineering on a large-scale simpler and faster. Many companies contend with hundreds or thousands of suspicious malware threats per day. Current popular solutions are insufficient most of the time.</p></p>
              <footer>
                  <ul class="buttons">
                      <li><a href="../docker-ida" class="button small">Read More</a></li>
                  </ul>
              </footer>
            </section>

          </div>
        </div>
    </section>
  </article>



<!-- Footer -->
<footer id="footer">

    <ul class="icons">
        <li>
          <a href="https://twitter.com/intezerlabs" class="icon circle fa fa-twitter"><span class="label">twitter</span></a>
        </li>
        <li>
          <a href="https://www.linkedin.com/company/intezer-labs" class="icon circle fa fa-linkedin"><span class="label">linkedin</span></a>
        </li>
        <li>
          <a href="http://github.com/intezer" class="icon circle fa fa-github"><span class="label">github</span></a>
        </li>
    </ul>

    <span class="copyright">&copy; Intezer Labs. All rights reserved.</span>

</footer>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-78232777-2', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>